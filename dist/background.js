(()=>{const e=["underdogfantasy.com","prizepicks.com"];let t=!1,o=null;const r=e=>{chrome.declarativeNetRequest.updateEnabledRulesets({enableRulesetIds:e?["block_betting_sites"]:[],disableRulesetIds:e?[]:["block_betting_sites"]}),console.log("Blocking rules updated:",e?"Block":"Unblock")};chrome.runtime.onInstalled.addListener((()=>{r(!0)})),chrome.runtime.onStartup.addListener((()=>{chrome.storage.local.get(["timerExpiration"],(e=>{const t=Date.now(),o=e.timerExpiration||0;if(t>=o)r(!0),chrome.storage.local.remove("timerExpiration");else{const e=o-t;r(!1),i(e/1e3)}}))}));const i=e=>{if(t)return;o&&clearTimeout(o);const i=Date.now()+1e3*e;chrome.storage.local.set({timerExpiration:i}),r(!1),t=!0,o=setTimeout((()=>{o=null,t=!1,r(!0),chrome.storage.local.remove("timerExpiration",(()=>{console.log("Timer expired, sites re-blocked")}))}),1e3*e),console.log("Timer started for:",e,"seconds")};chrome.runtime.onMessage.addListener(((s,n,c)=>("startTimer"!==s.action||t?"timerExpired"===s.action?(o&&(clearTimeout(o),o=null),r(!0),t=!1,chrome.storage.local.remove("timerExpiration"),c({success:!0})):"getBlockedSites"===s.action?c({blockedSites:e}):c({error:"Unknown action"}):(i(s.duration),c({success:!0})),!0))),setInterval((function(){chrome.runtime.reload()}),18e5)})();