(()=>{const e=["underdogfantasy.com","prizepicks.com"];let o=!1,t=null;const r=e=>{chrome.declarativeNetRequest.updateEnabledRulesets({enableRulesetIds:e?["block_betting_sites"]:[],disableRulesetIds:e?[]:["block_betting_sites"]}),console.log("Blocking rules updated:",e?"Block":"Unblock")};chrome.runtime.onInstalled.addListener((()=>{r(!0)})),chrome.runtime.onStartup.addListener((()=>{chrome.storage.local.get(["timerExpiration"],(e=>{const o=Date.now(),t=e.timerExpiration||0;if(o>=t)r(!0),chrome.storage.local.remove("timerExpiration");else{const e=t-o;r(!1),i(e/1e3)}}))}));const i=e=>{if(o)return;t&&clearTimeout(t);const i=Date.now()+1e3*e;chrome.storage.local.set({timerExpiration:i}),r(!1),o=!0,t=setTimeout((()=>{t=null,o=!1,r(!0),chrome.storage.local.remove("timerExpiration",(()=>{console.log("Timer expired, sites re-blocked")}))}),1e3*e),console.log("Timer started for:",e,"seconds")};chrome.runtime.onMessage.addListener(((s,n,c)=>("startTimer"!==s.action||o?"timerExpired"===s.action?(t&&(clearTimeout(t),t=null),r(!0),o=!1,chrome.storage.local.remove("timerExpiration"),c({success:!0})):"getBlockedSites"===s.action?c({blockedSites:e}):c({error:"Unknown action"}):(i(s.duration),c({success:!0})),!0)))})();